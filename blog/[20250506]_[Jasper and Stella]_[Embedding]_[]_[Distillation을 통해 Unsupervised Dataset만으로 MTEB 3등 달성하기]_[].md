# Jasper and Stella: distillation of SOTA embedding models

https://arxiv.org/html/2412.19048v2

# Abstract

### ðŸ’¡ ë…¼ë¬¸ì˜ í•µì‹¬ ì•„ì´ë””ì–´

> ì—¬ëŸ¬ ê°œì˜ ì„±ëŠ¥ ì¢‹ì€ ëŒ€í˜• ëª¨ë¸(teacher)ë¡œë¶€í„°
> 
> 
> **ìž‘ì€ í•˜ë‚˜ì˜ student ëª¨ë¸**ì´ ì§€ì‹ì„ íš¨ê³¼ì ìœ¼ë¡œ í•™ìŠµí•˜ë„ë¡
> 
> â†’ **3ë‹¨ê³„ distillation** ê¸°ë²•ì„ ê³ ì•ˆ
> 

ë˜í•œ,

- **Matryoshka Representation Learning (MRL)** ê¸°ë²•ìœ¼ë¡œ
    
    â†’ ë²¡í„° ì°¨ì›ë„ ì¤„ì´ë©´ì„œ ì„±ëŠ¥ ìœ ì§€
    

---

## ðŸ—ï¸ ê¸°ìˆ ì  êµ¬ì¡° ìš”ì•½

| êµ¬ì„± ìš”ì†Œ | ì„¤ëª… |
| --- | --- |
| **Multi-stage Distillation** | ì„±ëŠ¥ ì¢‹ì€ ì—¬ëŸ¬ teacher ëª¨ë¸ â†’ 1ê°œì˜ student ëª¨ë¸ì— distill |
| **3ê°€ì§€ Loss í•¨ìˆ˜** | teacherì˜ ì§€ì‹ì„ ë‹¤ê°ë„ë¡œ ì „ë‹¬í•˜ê¸° ìœ„í•œ loss ì„¤ê³„ |
| **MRL** | student ëª¨ë¸ì˜ ë²¡í„° ì°¨ì›ì„ ì¤„ì´ëŠ” ê¸°ë²•(**Matryoshka Representation Learning)** (ì˜ˆ: 1024 â†’ 384 ë“±) |
| **Student ëª¨ë¸ ì´ë¦„** | **Jasper (2B íŒŒë¼ë¯¸í„°)**, Stella ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë¨ |

---

# 1. Introduction

### 1ï¸âƒ£ **ë°°ê²½ ë° ë¬¸ì œì **

- **í…ìŠ¤íŠ¸ ìž„ë² ë”© ëª¨ë¸**ì€ ìžì—°ì–´ ì²˜ë¦¬ì˜ í•µì‹¬ (ê²€ìƒ‰, ìƒì„± ë“±ì—ì„œ ì‚¬ìš©)
- ë¬¸ìž¥ì´ë‚˜ ë¬¸ì„œë¥¼ ë²¡í„°ë¡œ ë°”ê¿”, ì˜ë¯¸ì ìœ¼ë¡œ ê°€ê¹Œìš´ ë¬¸ìž¥ë¼ë¦¬ **ë²¡í„° ê³µê°„ìƒì—ì„œ ê°€ê¹Œì›Œì§€ë„ë¡** í•™ìŠµí•¨

âœ… í•˜ì§€ë§Œ í˜„ìž¬ MTEB ë²¤ì¹˜ë§ˆí¬ì—ì„œ ìƒìœ„ê¶Œì¸ ëª¨ë¸ë“¤ì€:

- **ë§¤ìš° ë§Žì€ íŒŒë¼ë¯¸í„° ìˆ˜ (~7B)**
- **ë²¡í„° ì°¨ì›ì´ ë§¤ìš° í¼ (4096-dim)**

ðŸ“Œ **ë¬¸ì œì **: ì‹¤ë¬´ì— ì ìš©í•˜ê¸°ì—” *ëŠë¦¬ê³  ë¹„íš¨ìœ¨ì ì´ë©° ë¹„ìš©ì´ í¼* (ì„œë¹™ ë¶€ë‹´, ì €ìž¥ ë¬¸ì œ ë“±)

---

### 2ï¸âƒ£ **ì œì•ˆ ë°©ì‹: ìž‘ê³  íš¨ìœ¨ì ì¸ ìž„ë² ë”© ëª¨ë¸ ë§Œë“¤ê¸°**

> í° ëª¨ë¸ ì—¬ëŸ¬ ê°œì˜ "ì§€ì‹"ì„ í•˜ë‚˜ì˜ ìž‘ì€ ëª¨ë¸(Student)ì— ì••ì¶•í•´ì„œ ë‹´ì•„ë‚´ëŠ” ë°©ì‹ ì œì•ˆ
> 

### â›“ï¸ **Multi-stage Distillation êµ¬ì¡°**

- **ì—¬ëŸ¬ Teacher ëª¨ë¸** â†’ **í•˜ë‚˜ì˜ Student ëª¨ë¸**
- ë‹¨ìˆœ KDê°€ ì•„ë‹Œ, **3ê°€ì§€ Lossë¥¼ ì´ìš©í•œ ë‹¤ë‹¨ê³„ í•™ìŠµ**

| Loss ì¢…ë¥˜ | ì—­í•  ë° ì„¤ëª… |
| --- | --- |
| ðŸ”¹ Cosine Loss | ê°œë³„ ë¬¸ìž¥ì˜ ë²¡í„° ì°¨ì´ë¥¼ ìµœì†Œí™”í•¨ (ì ˆëŒ€ì  ìœ ì‚¬ë„ ì •ë ¬) |
| ðŸ”¸ Similarity Loss | ë¬¸ìž¥ ìŒì˜ ì˜ë¯¸ì  ê±°ë¦¬ ìœ ì§€ (semantic pairwise ì°¨ì´) |
| ðŸ”º Relative Similarity Loss | ë°°ì¹˜ ë‚´ ranking ì •ë³´ ìœ ì§€ (ì¢‹ì€ ê²ƒ, ë‚˜ìœ ê²ƒ êµ¬ë³„) |

---

### 3ï¸âƒ£ **ë²¡í„° ì°¨ì› ì¤„ì´ê¸°: Matryoshka Representation Learning (MRL)**

- ì—¬ëŸ¬ Teacherì˜ ë²¡í„°ë¥¼ concat í•˜ë©´ì„œ dimensionì´ ì»¤ì§
    
    â†’ **Matryoshka Representation Learning** ê¸°ë²•ì„ ì ìš©í•´ student ë²¡í„° ì°¨ì›ì„ íš¨ê³¼ì ìœ¼ë¡œ ì¶•ì†Œ (ì •ë³´ ì†ì‹¤ ìµœì†Œí™”)
    

ðŸ” ì°¸ê³ : Matryoshka Representation Learning ë°©ì‹ì˜ í•™ìŠµì€ ì—¬ëŸ¬ ì°¨ì›ìœ¼ë¡œ ë‚˜ëˆ , ë‹¤ì–‘í•œ ì°¨ì›ì—ì„œë„ ì˜ë¯¸ ë³´ì¡´ë˜ë„ë¡ í•™ìŠµ

---

### 4ï¸âƒ£ **ì¶”ê°€ ê¸°ë²•ë“¤**

- ðŸ” **4ë‹¨ê³„ distillation**: ê° ë‹¨ê³„ë§ˆë‹¤ lossì™€ fine-tune ëŒ€ìƒì´ ë‹¤ë¦„
- ðŸ–¼ï¸ **ë©€í‹°ëª¨ë‹¬ í™•ìž¥**: Vision encoder ë„ìž… + **Self-distillation**ìœ¼ë¡œ í…ìŠ¤íŠ¸-ë¹„ì „ ì •ë ¬

---

### 5ï¸âƒ£ **ì„±ê³¼**

- **Jasper ëª¨ë¸ (2B)** ì„±ëŠ¥:
    - MTEB í‰ê·  71.54ì  (56ê°œ ë°ì´í„°ì…‹ ê¸°ì¤€)
    - **7B ëª¨ë¸ê³¼ ìœ ì‚¬í•œ ì„±ëŠ¥**, **2B ì´í•˜ ëª¨ë¸ ëŒ€ë¹„ ìš°ì›”**
    - 2024ë…„ 12ì›” ê¸°ì¤€ MTEB ë¦¬ë”ë³´ë“œ 3ìœ„

---

## ðŸ” í•µì‹¬ ê¸°ì—¬ ìš”ì•½

|  | ê¸°ì—¬ ë‚´ìš© |
| --- | --- |
| âœ… 1 | ì—¬ëŸ¬ teacherë¡œë¶€í„° **3ê°€ì§€ loss ê¸°ë°˜ multi-stage distillation** ì„¤ê³„ |
| âœ… 2 | 2B í¬ê¸°ì˜ Jasper ëª¨ë¸ë¡œ **7B ëª¨ë¸ì— ê·¼ì ‘í•œ ì„±ëŠ¥ ë‹¬ì„±** |
| âœ… 3 | **Matryoshka Representation Learning ì ìš©ìœ¼ë¡œ ì°¨ì› ì¶•ì†Œ + ì„±ëŠ¥ ìœ ì§€** |
| âœ… 4 | ë©€í‹°ëª¨ë‹¬ ëŒ€ì‘, self-distillê¹Œì§€ í¬í•¨í•œ í™•ìž¥ì„± í™•ë³´ |

---

# **2. Methods**

### ðŸ—‚ï¸ ê°œë… ì •ì˜ (2.1 Definitions)

![image.png](attachment:8dc20957-6f29-45c9-a8e0-aac048c50b84:image.png)

---

## ðŸ§± 2.2 ëª¨ë¸ êµ¬ì¡° ìš”ì•½

JasperëŠ” **í…ìŠ¤íŠ¸ + ì´ë¯¸ì§€ ìž„ë² ë”©ì´ ê°€ëŠ¥í•œ ë©€í‹°ëª¨ë‹¬ ëª¨ë¸**ìž…ë‹ˆë‹¤:

![image.png](attachment:752ddb54-f3f4-41a3-b4e1-d44eed61c081:image.png)

1. **Language Encoder**: mean pooling ê¸°ë°˜ ë¬¸ìž¥ ìž„ë² ë”©
2. **Vision Encoder**: ì´ë¯¸ì§€ â†’ í† í° ë²¡í„°
3. **Pooler**: ì´ë¯¸ì§€ í† í° â†’ í…ìŠ¤íŠ¸ ì°¨ì›ì— ë§žê²Œ ë§¤í•‘
4. **FC Layers**: ë‹¤ì–‘í•œ ì°¨ì›ì˜ ìµœì¢… ë²¡í„° ì¶œë ¥

---

## ðŸ”„ 2.3 Stage 1 & 2: ë‹¤ì¤‘ Teacherë¡œë¶€í„° í…ìŠ¤íŠ¸ distillation

### ðŸ“Œ í•µì‹¬ ê°œë…

- NV-Embed-v2 (4096-d) + Stella (8192-d) â†’ **concatí•´ì„œ 12,288ì°¨ì›**
- Student ë²¡í„°ë„ FC1ì„ ê±°ì³ 12,288ì°¨ì›ìœ¼ë¡œ ë§Œë“¤ê³  align í•™ìŠµ

### ðŸ’¥ ì‚¬ìš©ëœ Loss 3ì¢…

![image.png](attachment:3e87574f-349b-4bf4-8696-090324245e14:image.png)

> ìµœì¢… ì†ì‹¤:
> 

![image.png](attachment:ba631879-227e-47d6-8c88-361d4e0ecbc0:image.png)

ðŸ§© ì°¨ì´ì :

- Stage 1: FC1ë§Œ í•™ìŠµ
- Stage 2: FC1 + encoder ë§ˆì§€ë§‰ 3ì¸µ í•™ìŠµ

---

## ðŸ”» 2.4 Stage 3: ë²¡í„° ì°¨ì› ì¶•ì†Œ

### âš ï¸ ë¬¸ì œ

- concatëœ ë²¡í„°ê°€ 12,288ì°¨ì› â†’ ì‹¤ë¬´ ì ìš© ì–´ë ¤ì›€

### âœ… í•´ê²°ì±…

- FC2, FC3, FC4ë¡œ ê°ê° ì°¨ì› ì¶•ì†Œ (ì˜ˆ: FC3 â†’ 512ì°¨ì›)
- **Matryoshka Representation Learning** ê¸°ë²• ì°¸ê³  â†’ ì—¬ëŸ¬ í¬ê¸°ì˜ ë²¡í„°ê°€ ìœ íš¨í•˜ë„ë¡ í•™ìŠµ

![image.png](attachment:1ce27beb-fca7-4c31-a4de-bd40c0610a60:image.png)

---

### ðŸŒ± Self-distillation ê¸°ë²• ì œì•ˆ

- FC1 (12288-d)ì˜ ë²¡í„°ë¥¼ "teacher"ë¡œ ë³´ê³ ,
- FC2/3/4 ë²¡í„°ë¥¼ "student"ë¡œ ì‚¼ì•„ ìžì²´ í•™ìŠµ ê°€ëŠ¥
- ì´ê±´ ë…¼ë¬¸ì—ì„œëŠ” **ì œì•ˆë§Œ í•˜ê³  ì‹¤í—˜ì€ ì•ˆí•¨**

---

## ðŸ–¼ï¸ 2.5 Stage 4: ë©€í‹°ëª¨ë‹¬ í•™ìŠµ

- **Image-caption pairs**ë¡œ í•™ìŠµ
- Caption ë²¡í„° â†’ Teacher
    
    Image ë²¡í„° â†’ Student
    
    â†’ Self-distillation ë°©ì‹ìœ¼ë¡œ ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ ë²¡í„° ì •ë ¬
    
    â†’ 3ê°œì˜ loss(cosine + sim + resim) ë¥¼ í‰ê· ë‚´ì–´ ìµœì¢… loss ì‚°ì¶œ
    

ðŸ“Œ í˜„ìž¬ëŠ” *ê¸°ì´ˆì ì¸ ì •ë ¬ ìˆ˜ì¤€*ë§Œ ë‹¬ì„±, í–¥í›„ ê°œì„  ì—¬ì§€ ë§ŽìŒ

---

## âœ… Jasper í•™ìŠµ êµ¬ì¡° ìš”ì•½

| Stage | ì£¼ìš” ëª©í‘œ | í•™ìŠµ ëŒ€ìƒ | ì†ì‹¤ í•¨ìˆ˜ |
| --- | --- | --- | --- |
| 1 | teacher ì •ë ¬ | FC1 | cosine + sim + resim |
| 2 | encoder í•™ìŠµ | FC1 + encoder ë§ˆì§€ë§‰ 3ì¸µ | ë™ì¼ |
| 3 | ë²¡í„° ì¶•ì†Œ | FC2~FC4 + ì „ì²´ ëª¨ë¸ | sim + resim |
| 4 | ë¹„ì „ ì •ë ¬ | Vision encoder | cosine + sim + resim |

---

## 3. Experiments ìš”ì•½ + í•´ì„¤

### ðŸ“Š Table 1: MTEB ì„±ëŠ¥ ë¹„êµ

| ëª¨ë¸ | íŒŒë¼ë¯¸í„° | í‰ê·  ì ìˆ˜ | Retrieval | STS | ë¶„ë¥˜ | ê¸°íƒ€ |
| --- | --- | --- | --- | --- | --- | --- |
| **NV-Embed-v2** | 7.85B | **72.31** | 60.65 | 62.65 | 90.37 | Top-1 |
| **bge-en-icl** | 7.1B | 71.67 | 59.86 | 62.16 | 88.95 |  |
| **Jasper (ours)** | 1.9B | **71.54** | 60.91 | 61.33 | 88.49 | ðŸ… Top-3 |
| **Stella (student init)** | 1.5B | 71.19 | 61.21 | 61.01 | 87.63 |  |
| **gte-Qwen2** | 1.7B | 67.16 | 59.98 | 58.29 | 82.47 |  |
| **voyage-lite-02** | 1.2B | 67.13 | 58.24 | 56.60 | 79.25 |  |

âœ… **ê²°ë¡ **:

- JasperëŠ” **2B ë¯¸ë§Œ ëª¨ë¸ ì¤‘ ìµœê³  ì„±ëŠ¥**
- íŒŒë¼ë¯¸í„° ìˆ˜ê°€ 3~4ë°° ë§Žì€ ìƒìœ„ ëª¨ë¸ê³¼ë„ **ì„±ëŠ¥ ê²©ì°¨ ê±°ì˜ ì—†ìŒ**
- íŠ¹ížˆ **retrieval / STS** ë¶€ë¬¸ì—ì„œ **NV-Embedì™€ ìœ ì‚¬í•˜ê±°ë‚˜ ë” ë‚˜ì€ ì„±ê³¼**

---

## âš™ï¸ 3.1 Implementation Details

| í•­ëª© | ì„¤ì • |
| --- | --- |
| ì´ˆê¸°í™” | `stella_en_1.5B_v5` + `google/siglip 400M` |
| ì´ íŒŒë¼ë¯¸í„° | 1.9B |
| ì†ì‹¤ ê°€ì¤‘ì¹˜ | Î»â‚=10, Î»â‚‚=200, Î»â‚ƒ=20, margin=0.015 |
| GPU | RTX A6000 Ã— 8 |
| í•™ìŠµ precision | bf16 + DeepSpeed ZeRO-2 |
| ìµœëŒ€ ìž…ë ¥ ê¸¸ì´ | 512 tokens |

### ðŸ“Œ Stageë³„ í•™ìŠµ ì „ëžµ

| Stage | ëª©í‘œ | ëŸ¬ë‹ë ˆì´íŠ¸ | ìµœì¢… ìŠ¤í… |
| --- | --- | --- | --- |
| 1 | Teacher KD | 1e-4 | 4000 |
| 2 | KD + Encoder íŠœë‹ | 8e-5 | 7000 |
| 3 | ë²¡í„° ì°¨ì› ì¶•ì†Œ | 7e-5 | 2200 |
| 4 | ë©€í‹°ëª¨ë‹¬ ì •ë ¬ | 1e-4 | 3500 |

---

## ðŸ“š 3.2 Dataset êµ¬ì„± ì „ëžµ

### ðŸ”¤ í…ìŠ¤íŠ¸ í•™ìŠµ ë°ì´í„° (Stage 1~3)

- **Fineweb-Edu** (80%) + **Sentence-Transformers ë°ì´í„°** (20%)
- ì´ í…ìŠ¤íŠ¸ ìˆ˜: **800ë§Œ ë¬¸ì„œ**

ðŸ“Œ ì „ì²˜ë¦¬ ë°©ì‹:

- 30%ëŠ” 1~10ë¬¸ìž¥ ë‹¨ìœ„ë¡œ ë¶„í•  â†’ **ë¬¸ìž¥ ë‹¤ì–‘ì„± ì¦ê°€**
- 0.08%ëŠ” ë‹¨ì–´ ìˆœì„œë¥¼ ì„žìŒ â†’ **ìˆœì„œì— ê°•ì¸í•œ í•™ìŠµ ìœ ë„**

### ðŸ–¼ï¸ ì´ë¯¸ì§€-ìº¡ì…˜ ë°ì´í„° (Stage 4)

- ì‚¬ìš© ë°ì´í„°: **BAAI/Infinity-MM**
- caption â†’ teacher, image â†’ studentë¡œ self-distillation

---

## âœ… 3.3 ì„±ëŠ¥ ìš”ì•½ (í•µì‹¬ í¬ì¸íŠ¸)

| ì¸¡ë©´ | í•´ì„¤ |
| --- | --- |
| ðŸ”¹ íŒŒë¼ë¯¸í„° ìˆ˜ ëŒ€ë¹„ ì„±ëŠ¥ | 7B ëª¨ë¸ê³¼ ê±°ì˜ ë™ë“±í•œ ì„±ëŠ¥ (â†’ distillation íš¨ê³¼ ëšœë ·) |
| ðŸ”¸ Retrieval, STS ê°•ì„¸ | RAG, FAQ ê°™ì€ ì‘ìš©ì—ì„œ íŠ¹ížˆ ì¤‘ìš” |
| ðŸ”¹ ë²¡í„° ì°¨ì› ì¶•ì†Œì—ë„ ì„±ëŠ¥ ìœ ì§€ | MRL ê¸°ë°˜ ì°¨ì› ì¶•ì†Œ ì „ëžµ ìœ íš¨ |
| ðŸ”¸ ë©€í‹°ëª¨ë‹¬ ì˜ˆë¹„ ì„±ëŠ¥ í™•ë³´ | ì¶”í›„ Cross-modal alignment í™•ìž¥ ê°€ëŠ¥ì„± ë³´ì—¬ì¤Œ |

---

## 4. Discussion

### ðŸ§­ 4.1 Instruction Robustness

> "Instruction ê¸°ë°˜ ìž„ë² ë”© ëª¨ë¸ì˜ í”„ë¡¬í”„íŠ¸ ë¯¼ê°ë„" ì‹¤í—˜
> 

ðŸ“Œ ë°°ê²½

- ìµœê·¼ì˜ embedding ëª¨ë¸ë“¤(BGE ë“±)ì€ task-specific instructionì„ ë¶™ì—¬ì„œ queryë¥¼ ì¸ì½”ë”©í•¨
    
    â†’ `Query: {text}`, `Represent this sentence for retrieval: {text}` ë“±
    
- í•˜ì§€ë§Œ ì‹¤ì‚¬ìš©ì—ì„œëŠ” instructionì´ **ë‹¤ì–‘í•˜ê²Œ ë³€í˜•**ë  ìˆ˜ ìžˆìŒ â†’ ì´ì— ëŒ€í•œ **ê°•ê±´ì„±(robustness)** ì¤‘ìš”

ðŸ“Œ ì‹¤í—˜

- GPT-4oë¡œ ë‹¤ì–‘í•œ instruction ë³€í˜• ìƒì„±
- ë™ì¼í•œ taskì— ëŒ€í•´ Jasper ëª¨ë¸ì´ í”„ë¡¬í”„íŠ¸ì— ì–¼ë§ˆë‚˜ ì˜í–¥ì„ ë°›ëŠ”ì§€ í…ŒìŠ¤íŠ¸

ðŸ“Œ ê²°ê³¼

- JasperëŠ” instructionì´ ë°”ë€Œì–´ë„ ì„±ëŠ¥ ì €í•˜ ì—†ì´ **ì¼ê´€ëœ ë²¡í„° í‘œí˜„** ìƒì„±
- âœ… **Instruction Robustness í™•ë³´**

ðŸ’¡ **ì˜ì˜**

- ì‹¤ì‚¬ìš©ì—ì„œ ì‚¬ìš©ìžê°€ ë‹¤ì–‘í•œ í˜•íƒœì˜ ì§ˆì˜ë¥¼ ë˜ì ¸ë„ ì•ˆì •ì ì¸ ê²€ìƒ‰ ì„±ëŠ¥ ê°€ëŠ¥
- FAQ/RAGì—ì„œ **ìžì—°ì–´ ì§ˆì˜ ë‹¤ì–‘ì„±**ì— ìœ ì—°í•˜ê²Œ ëŒ€ì‘ ê°€ëŠ¥

---

### ðŸ–¼ï¸ 4.2 Vision Encodingì˜ ê°œì„  ì—¬ì§€

ðŸ“Œ í˜„ìž¬ ì„¤ì •:

- Stage 4ì—ì„œëŠ” ì´ë¯¸ì§€-ë¬¸ìž¥ ì •ë ¬ì„ ìœ„í•œ **ê¸°ì´ˆ self-distillationë§Œ ìˆ˜í–‰**
- Vision encoderëŠ” `google/siglip` ì‚¬ìš©í–ˆìœ¼ë‚˜, í›ˆë ¨ì€ ë§¤ìš° ì œí•œì 

ðŸ“Œ í•œê³„ ë° í–¥í›„ ê³„íš:

| ì´ìŠˆ | ê°œì„  ë°©í–¥ |
| --- | --- |
| Loss ì§„ë™ ë°œìƒ (unstable training) | í•™ìŠµ ìŠ¤ì¼€ì¤„ë§/ë°ì´í„° ì¦ê°•/contrastive loss ë„ìž… í•„ìš” |
| ì´ë¯¸ì§€-ë¬¸ìž¥ ì •ë ¬ ì•½í•¨ | Stage 5: **VQA ë°ì´í„° ê¸°ë°˜ contrastive í•™ìŠµ** ì˜ˆì • |
| ë©€í‹°ëª¨ë‹¬ í•™ìŠµ ê¹Šì´ ë¶€ì¡± | modality fusion êµ¬ì¡° í™•ìž¥ or dual encoder â†’ cross encoder ì „í™˜ ê³ ë ¤ ê°€ëŠ¥ |

---

# ì§ˆë¬¸ ì‚¬í•­

## 1. Jasperê°€ Stellaë¥¼ teacherë¡œ ì‚¼ëŠ” êµ¬ì¡° ìš”ì•½

| ì—­í•  | ëª¨ë¸ | ì„¤ëª… |
| --- | --- | --- |
| Init ëª¨ë¸ | **Stella (stella_en_1.5B_v5)** | Jasperê°€ ì´ ëª¨ë¸ì˜ íŒŒë¼ë¯¸í„°ë¡œë¶€í„° ì‹œìž‘ |
| Teacher 1 | **Stella (ë™ì¼)** | Jasperê°€ ë”°ë¼ì•¼ í•  target vector ì¤‘ í•˜ë‚˜ |
| Teacher 2 | **NV-Embed-v2** | ì¶”ê°€ë¡œ distillí•  SOTA ìž„ë² ë”© ëª¨ë¸ (7.8B) |

ì¦‰,

- JasperëŠ” **Stellaì˜ êµ¬ì¡°ì™€ íŒŒë¼ë¯¸í„°ë¥¼ ê·¸ëŒ€ë¡œ ì´ì–´ë°›ë˜**
- ë™ì‹œì— Stellaì˜ ë²¡í„° í‘œí˜„ì„ **teacherì˜ ê¸°ì¤€ê°’ ì¤‘ í•˜ë‚˜ë¡œ ì‚¬ìš©**í•´ì„œ ê·¸ì— ë§žì¶° ì¶œë ¥ ë²¡í„°ë¥¼ ì •ë ¬í•¨

---

## ðŸ” ì™œ ìžê¸° ìžì‹ ì„ teacherë¡œ ì‚¼ì„ê¹Œ?

ì´ê±´ **knowledge distillationì˜ ì‹¤ìš©ì  ì‘ìš©**ìž…ë‹ˆë‹¤:

- ì¼ë°˜ì ìœ¼ë¡œ distillationì€ í° ëª¨ë¸ â†’ ìž‘ì€ ëª¨ë¸ë¡œ í•˜ëŠ”ë°,
- JasperëŠ” ê°™ì€ í¬ê¸°ì˜ ëª¨ë¸(Stella 1.5B)ë¡œ ì´ˆê¸°í™”í•˜ê³ ë„,
- **ë‹¤ì¤‘ teacher(= Stella + NV-Embed)ì˜ í‘œí˜„ì„ ëª¨ë‘ ë°˜ì˜í•˜ì—¬ ìž¬í•™ìŠµ**í•©ë‹ˆë‹¤.

ì¦‰,

> "Stellaì—ì„œ ì‹œìž‘í•˜ì§€ë§Œ Stellaë¥¼ ì´ˆì›”í•œ Jasperë¥¼ ë§Œë“¤ê¸° ìœ„í•œ ì „ëžµ"
> 
> 
> (Stellaê°€ ê°€ì§„ ì§€ì‹ + NV-Embedê°€ ê°€ì§„ í‘œí˜„ë ¥ â‡’ Jasperê°€ ëª¨ë‘ í¡ìˆ˜)
> 

---

## ðŸ“Œ ì •ë¦¬

- JasperëŠ” **Stellaë¡œ ì´ˆê¸°í™”ë˜ì—ˆì§€ë§Œ**,
    
    ë™ì‹œì— **Stellaë¥¼ teacherë¡œ ì‚¼ì•„ output ì •ë ¬**ì„ ìˆ˜í–‰í•¨
    
- ì´ëŠ” **"ìžê¸° ìžì‹  + ì™¸ë¶€ teacher"ë¡œë¶€í„° ì§€ì‹ì„ ì¦ë¥˜**í•˜ëŠ” ì…€í”„ ë””ìŠ¤í‹¸ ì „ëžµì´ë©°,

# 2. ì´ë¯¸ì§€ íŒŒíŠ¸ distillation êµ¬ì¡° ìš”ì•½ (Stage 4 ê¸°ì¤€)

| ì—­í•  | ì„¤ëª… |
| --- | --- |
| ðŸ“œ í…ìŠ¤íŠ¸ (caption) | **teacher vector**ë¡œ ì‚¬ìš© |
| ðŸ–¼ï¸ ì´ë¯¸ì§€ | vision encoderì˜ ì¶œë ¥ â†’ **student vector**ë¡œ ê°„ì£¼ |
| ðŸ“ ì†ì‹¤ ê³„ì‚° | í…ìŠ¤íŠ¸ ë²¡í„°ì™€ ì´ë¯¸ì§€ ë²¡í„° ê°„ cosine/similarity/resim loss ê³„ì‚° (ì´ 3ê°œ loss í‰ê· ) |
| ðŸ” ë°©ì‹ | **self-distillation** (í…ìŠ¤íŠ¸=ìŠ¤ìŠ¤ë¡œ ë§Œë“  ê¸°ì¤€ â†’ ì´ë¯¸ì§€ê°€ ê·¸ê±¸ ë”°ë¼ê°€ë„ë¡ í•™ìŠµ) |
| âŒ ë³„ë„ ì´ë¯¸ì§€ teacher | ì—†ìŒ (CLIPì´ë‚˜ siglipê³¼ ê°™ì€ ì‚¬ì „í•™ìŠµëœ teacherë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ) |

## ðŸ¤” ì™œ ì´ë¯¸ì§€ teacherê°€ ì—†ì„ê¹Œ?

1. **ë¦¬ì†ŒìŠ¤/ì‹œê°„ ë¶€ì¡±** (ë…¼ë¬¸ì—ì„œë„ ì–¸ê¸‰)
2. Stage 4ëŠ” **ì´ˆê¸° ì‹œë„ ìˆ˜ì¤€**ì´ë©°, í–¥í›„ Stage 5ì—ì„œ
    - **VQA ë°ì´í„°**
    - **contrastive learning**
    - ë˜ëŠ” **CLIP/siglipì„ teacherë¡œ ì‚¼ëŠ” í™•ìž¥ êµ¬ì¡°**
    
    ë¥¼ ê³ ë ¤í•˜ê³  ìžˆë‹¤ê³  ì•”ì‹œí•¨
    

---

# 3. ì‚¬ìš©í•œ ë°ì´í„° ì…‹

**ì‚¬ìš©í•œ ë°ì´í„°ì…‹ì€ ëª¨ë‘ ë¹„ì§€ë„ í•™ìŠµ(unlabeled, unsupervised)ìš© ë°ì´í„°ì…‹ìž…ë‹ˆë‹¤.**

ì¦‰, **ì •ë‹µ(label)ì´ ìžˆëŠ” supervised datasetì€ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.**

## ðŸ“š ì‚¬ìš©ëœ ë°ì´í„°ì…‹ ì •ë¦¬ (ë…¼ë¬¸ ê¸°ì¤€)

### ðŸ”¹ Stage 1~3 (í…ìŠ¤íŠ¸ ìž„ë² ë”© í•™ìŠµ)

| ë°ì´í„°ì…‹ | ë¹„ìœ¨ | ì„¤ëª… |
| --- | --- | --- |
| `fineweb-edu` | 80% | **ë¬¸ë‹¨ ì¤‘ì‹¬ì˜ ë¹„ì§€ë„ í…ìŠ¤íŠ¸ ë°ì´í„°** |
| `sentence-transformers/embedding-training-data` | 20% | ë¹„ì§€ë„ ë¬¸ìž¥/ì§ˆë¬¸ ë°ì´í„° (ë‹¤ì–‘ì„± í™•ë³´ ëª©ì ) |

ðŸ“Œ ì£¼ì˜: `sentence-transformers`ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ì…‹ ì¤‘ ì¼ë¶€ëŠ” NLI ë“± supervisedí•œ ê²ƒë„ ìžˆì§€ë§Œ,

**ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•œ ë²„ì „ì€ labeled taskìš©ì´ ì•„ë‹Œ ë¹„ì§€ë„ìš© pair data**ìž…ë‹ˆë‹¤.

### ðŸ”¹ Stage 4 (ë©€í‹°ëª¨ë‹¬ ì •ë ¬ í•™ìŠµ)

| ë°ì´í„°ì…‹ | ì„¤ëª… |
| --- | --- |
| `BAAI/Infinity-MM` | **ì´ë¯¸ì§€-ìº¡ì…˜ ìŒ** (captionì„ í…ìŠ¤íŠ¸ teacherë¡œ ì‚¬ìš©) |

---

## ðŸ§  ë…¼ë¬¸ì´ ëª…ì‹œí•œ í•µì‹¬ ë¬¸ìž¥

> â€œWe do not need any supervised data. Without considering resource constraints, we can use trillions of unsupervised texts for distillation trainingâ€¦â€
> 

â†’ ì¦‰, ë…¼ë¬¸ ìžì²´ê°€ **supervised data ì—†ì´ë„ SOTA ì„±ëŠ¥ì„ ë‚¼ ìˆ˜ ìžˆëŠ” embedding ëª¨ë¸ì„ ë§Œë“ ë‹¤**ëŠ” ê²ƒì´ í•µì‹¬ ì·¨ì§€ìž…ë‹ˆë‹¤.

---

# 4. 2.4 Stage 3: ë²¡í„° ì°¨ì› ì¶•ì†Œ ë¶€ë¶„ì—ì„œ ì™œ cosine lossëŠ” ì œì™¸í–ˆì„ê¹Œ?

> Stage 3ì—ì„œëŠ” teacher ë²¡í„°ì™€ student ë²¡í„°ì˜ ì°¨ì›ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— cosine lossë¥¼ ì“¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
> 
> 
> â†’ ëŒ€ì‹  **similarity loss**ì™€ **relative similarity loss**ë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
> 

---

## ðŸ§  ë°°ê²½ ì´í•´

### ðŸ”¹ Stage 1 & 2:

- teacher ë²¡í„° = concat(4096 + 8192) = **12,288ì°¨ì›**
- student ë²¡í„° = FC1ì„ í†µí•´ ë™ì¼í•˜ê²Œ **12,288ì°¨ì›**
- âœ… ë”°ë¼ì„œ cosine ìœ ì‚¬ë„ ì§ì ‘ ê³„ì‚° ê°€ëŠ¥ â†’ `â„’_cosine` ì‚¬ìš©

---

### ðŸ”» Stage 3: ì°¨ì› ì¶•ì†Œ

- student ë²¡í„°ëŠ” FC2/FC3/FC4ë¥¼ í†µí•´ **512, 768, 1024ì°¨ì› ë“± ë‹¤ì–‘í•œ ì €ì°¨ì›**ìœ¼ë¡œ ì••ì¶•ë¨
- í•˜ì§€ë§Œ teacher ë²¡í„°ëŠ” ì—¬ì „ížˆ **12,288ì°¨ì›**

âš ï¸ ë¬¸ì œ:

> Cosine ìœ ì‚¬ë„ = ë‘ ë²¡í„°ì˜ ë‚´ì  / (norm ê³±)
> 
> 
> â†’ **ì°¨ì›ì´ ë‹¤ë¥´ë©´ ì •ì˜ ìžì²´ê°€ ë¶ˆê°€ëŠ¥**
> 

---

## ðŸ” ì™œ ë‹¤ë¥¸ lossëŠ” ê°€ëŠ¥í•œê°€?

| Loss | ì°¨ì› ë§žì¶°ì•¼ í•˜ë‚˜? | ì„¤ëª… |
| --- | --- | --- |
| `cosine loss` | âœ… í•„ìš”í•¨ | ë²¡í„° ê°„ ì§ì ‘ ë¹„êµ |
| `similarity loss` | âŒ ë¶ˆí•„ìš” | ìœ ì‚¬ë„ í–‰ë ¬ë¼ë¦¬ ë¹„êµ â†’ ë‚´ì  ê¸°ë°˜ similarity ë¹„êµ |
| `relative similarity loss` | âŒ ë¶ˆí•„ìš” | positive vs. negative ê°„ **ìƒëŒ€ ìœ ì‚¬ë„**ë§Œ ê³ ë ¤í•˜ë©´ ë¨ |

â†’ ì¦‰, **cosine lossëŠ” ì ˆëŒ€ í‘œí˜„ ì •ë ¬ì´ í•„ìš”í•œ ë°˜ë©´**,

ë‹¤ë¥¸ ë‘ lossëŠ” **ìƒëŒ€ ê´€ê³„ë§Œ ë§žì¶”ë©´ ë˜ê¸° ë•Œë¬¸ì— ì°¨ì›ì´ ë‹¬ë¼ë„ í•™ìŠµì´ ê°€ëŠ¥**í•©ë‹ˆë‹¤.

---

# 5. **Relative Similarity Loss ë¶€ì—°ì„¤ëª…**

ì¢‹ìŠµë‹ˆë‹¤. ì´ ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•œ ëŠ” ì¼ë°˜ì ì¸ contrastive lossì˜ ë³€í˜•ìœ¼ë¡œ,

**CoSENT (Cosine Sentence Embedding Training)**ì—ì„œ ì˜ê°ì„ ë°›ì•„ ì„¤ê³„ëœ **ranking ê¸°ë°˜ì˜ margin loss**ìž…ë‹ˆë‹¤.

---

## ðŸŽ¯ ëª©ì 

> ë¬¸ìž¥ ê°„ ìƒëŒ€ì  ìœ ì‚¬ë„(ìˆœì„œ)ë¥¼ ë³´ì¡´í•˜ê¸° ìœ„í•´,
> 
> 
> **positive ìŒì€ negative ìŒë³´ë‹¤ ë” ë†’ì€ ìœ ì‚¬ë„ë¥¼ ê°€ì§€ë„ë¡** í•™ìŠµì‹œí‚´.
> 

---

## ðŸ“ ìˆ˜ì‹ (ë…¼ë¬¸ ì •ì˜ ê¸°ì¤€)

![image.png](attachment:6fc5c989-461f-41b6-a965-d0a82945db7c:image.png)

---

## ðŸ§  ìž‘ë™ ë°©ì‹ (ì˜ˆì‹œ)

1. Teacher ëª¨ë¸ ê¸°ì¤€ìœ¼ë¡œ **ë¬¸ìž¥ A > ë¬¸ìž¥ B** (ìœ ì‚¬ë„ê°€ ë” ë†’ìŒ)ë¼ê³  íŒë‹¨ë˜ë©´
2. StudentëŠ” ë°˜ë“œì‹œ **A ìŒì˜ ìœ ì‚¬ë„ > B ìŒì˜ ìœ ì‚¬ë„ + margin**ì´ ë˜ë„ë¡ í•™ìŠµ
3. ì´ë¥¼ ìœ„ë°˜í•˜ëŠ” ê²½ìš°ì—ë§Œ loss ë°œìƒ â†’ hinge ê¸°ë°˜ margin loss

---

## ðŸ” ì™œ í•„ìš”í•œê°€?

- **Cosine loss**ëŠ” ì ˆëŒ€ ë²¡í„° ì •ë ¬ â†’ ì˜ë¯¸ëŠ” ìœ ì§€í•´ë„ ë°©í–¥ì´ ì¡°ê¸ˆ ë‹¤ë¥´ë©´ íŒ¨ë„í‹°
- **Similarity loss**ëŠ” ì „ì²´ ìœ ì‚¬ë„ í–‰ë ¬ ì •ë ¬ â†’ ë…¸ì´ì¦ˆì— ë¯¼ê°í•  ìˆ˜ ìžˆìŒ
- ðŸ‘‰ **Relative similarity loss**ëŠ” ìˆœì„œ ì •ë³´ë§Œ ë³´ì¡´ â†’ **ì¼ë°˜í™” ì„±ëŠ¥ì— ë§¤ìš° ìœ ë¦¬**

íŠ¹ížˆ ë°°ì¹˜ ë‚´ì—ì„œ ë‹¤ì–‘í•œ ë¬¸ìž¥ìŒì„ ë¹„êµí•  ìˆ˜ ìžˆê¸° ë•Œë¬¸ì—

â†’ **ê¸ì •/ë¶€ì • ìŒì˜ êµ¬ì¡°ì ì¸ ê´€ê³„**ë¥¼ í•™ìƒ ëª¨ë¸ì´ ìž˜ ë°°ìš¸ ìˆ˜ ìžˆìŒ

---

# 6. vision ë¶€ë¶„ ì„¸ë¶€ì„¤ëª…

### ðŸ”¹ Stage 4: ë©€í‹°ëª¨ë‹¬ í•™ìŠµ

- image-caption ìŒì„ ì´ìš©í•´ **ê¸°ì´ˆì ì¸ ì •ë ¬(aligning)**ë§Œ ìˆ˜í–‰
- vision encoder(siglip ê¸°ë°˜)ëŠ” ì˜¤ì§ **self-distillation** ë°©ì‹ìœ¼ë¡œ í•™ìŠµë¨
    - captionì˜ ë²¡í„° â†’ teacher
    - ì´ë¯¸ì§€ ë²¡í„° â†’ student
    - ì„¸ ê°€ì§€ loss(cosine, sim, resim)ë¥¼ í‰ê· 

### ðŸ”¹ í‰ê°€ ê´€ë ¨ ì§ì ‘ ì–¸ê¸‰

ë…¼ë¬¸ 4.2ì ˆ(Discussion)ì— ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ìž¥ì´ ë‚˜ì˜µë‹ˆë‹¤:

> â€œWe were only able to equip the Jasper model with a basic image encoding capability. ... Overall, there is considerable room for enhancement in the multimodal training.â€
> 

ì¦‰:

- ì‹¤í—˜ì€ í–ˆìœ¼ë‚˜ ì •ëŸ‰ì  ì§€í‘œ ì—†ìŒ
- ì„±ëŠ¥ì„ ê²€ì¦í•  **ë©€í‹°ëª¨ë‹¬ ë²¤ì¹˜ë§ˆí¬(VQA, MSCOCO, Flicker30k ë“±)**ëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
- í–¥í›„ Stage 5ì—ì„œ vision-language contrastive learning ë„ìž…ì„ ì˜ˆê³ ë§Œ í•¨

---

## ðŸ§  ìš”ì•½í•˜ë©´

| í•­ëª© | ìƒíƒœ |
| --- | --- |
| ì´ë¯¸ì§€ ìž…ë ¥ í—ˆìš© | âœ… yes (`siglip` encoder ì‚¬ìš©) |
| ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ì •ë ¬ í•™ìŠµ | âœ… yes (Stage 4ì—ì„œ self-distillation ìˆ˜í–‰) |
| ë©€í‹°ëª¨ë‹¬ ì„±ëŠ¥ í‰ê°€ | âŒ no (ë…¼ë¬¸ì— í‰ê°€ ì§€í‘œ ì—†ìŒ) |
| í–¥í›„ í™•ìž¥ ê°€ëŠ¥ì„± | âœ… Stage 5ì—ì„œ VQA ê¸°ë°˜ contrastive í•™ìŠµ ì–¸ê¸‰ |

---

## ðŸ“Œ ì „ë¬¸ê°€ ê´€ì  ì •ë¦¬

> JasperëŠ” í˜„ìž¬ í…ìŠ¤íŠ¸ ì¤‘ì‹¬ ëª¨ë¸ì´ë©°, vision encoderëŠ” "ê¸°ì´ˆì ì¸ ì •ë ¬ ê¸°ëŠ¥ë§Œ íƒ‘ìž¬ëœ ìƒíƒœ"ìž…ë‹ˆë‹¤.
> 
> 
> â†’ **ë©€í‹°ëª¨ë‹¬ í™•ìž¥ ê°€ëŠ¥ì„±ì„ ì—´ì–´ë‘” í”„ë¡œí† íƒ€ìž… ìˆ˜ì¤€**ìœ¼ë¡œ ë³´ëŠ” ê²ƒì´ ì ì ˆí•©ë‹ˆë‹¤.
> 

Text ë¶€ë¶„ teacher ëª¨ë¸ í¬ê¸° : NV-Embed 7.85B  + stella 1.5B â†’ ì•½ 9B

ì´ë¯¸ì§€ ë¶€ë¶„ teacher ëª¨ë¸ í¬ê¸° : 400M?

# 7. Teacher ëª¨ë¸ì— ìžê¸°ìžì‹ (stella)ì´ ì¡´ìž¬í•˜ëŠ” ì´ìœ 

ì™œ **NV-Embed í•˜ë‚˜ë§Œìœ¼ë¡œ distillationì„ í•˜ì§€ ì•Šê³ **,

**ì´ˆê¸°í™”(init) ëª¨ë¸ì¸ Stellaë¥¼ teacherë¡œë„ ì¶”ê°€í–ˆëŠ”ê°€?**

â†’ ì—¬ê¸°ì— ë‹´ê¸´ ì´ìœ ëŠ” **ê¸°ìˆ ì , ì‹¤ìš©ì , í•™ìŠµ ì•ˆì •ì„± ì¸¡ë©´ ëª¨ë‘ë¥¼ ê³ ë ¤í•œ ì „ëžµ**ìž…ë‹ˆë‹¤.

---

## ðŸ” ìš”ì•½: Stellaë„ teacherë¡œ ì“´ ì´ìœ 

| ì´ìœ  | ì„¤ëª… |
| --- | --- |
| ðŸ§  **ì´ˆê¸° íŒŒë¼ë¯¸í„°ì™€ì˜ ì •ë ¬** | ì´ˆê¸°í™”ëœ Stellaì˜ í‘œí˜„ì„ ìœ ì§€í•˜ë©´ì„œ í•™ìŠµ ë°©í–¥ì„±ì„ ìž¡ì•„ì¤Œ â†’ **í•™ìŠµ ì•ˆì •ì„± í–¥ìƒ** |
| ðŸŽ¯ **ë‹¤ì–‘í•œ í‘œí˜„ í•™ìŠµ** | NV-Embedì™€ StellaëŠ” **í‘œí˜„ ë°©ì‹ì´ ë‹¤ë¦„** â†’ ë‘ ëª¨ë¸ì˜ ì§€ì‹ì„ **ë³´ì™„ì ìœ¼ë¡œ distill** |
| âš–ï¸ **Teacher blending** | NV-Embedë§Œ ì“°ë©´ íŠ¹ì • í‘œí˜„ì— **ê³¼ë„í•˜ê²Œ ì ë¦¼ í˜„ìƒ**ì´ ìƒê¸¸ ìˆ˜ ìžˆìŒ |
| ðŸš« **NV-EmbedëŠ” 7.8B** | ë„ˆë¬´ í¬ê³  í‘œí˜„ì´ ë³µìž¡í•´ì„œ ìž‘ì€ ëª¨ë¸(Jasper)ì—ê²Œ ê·¸ëŒ€ë¡œ ë„˜ê¸°ë©´ **í‘œí˜„ ì™œê³¡** ìœ„í—˜ â†’ Stellaê°€ ì¤‘ê°„ ìˆ˜ì¤€ teacher ì—­í•  |

---

## ðŸ”¬ ì¡°ê¸ˆ ë” ìžì„¸ížˆ í’€ì–´ë³´ë©´â€¦

### 1ï¸âƒ£ í•™ìŠµ ì•ˆì •ì„±ê³¼ ìˆ˜ë ´ ìœ ë„

- JasperëŠ” **Stellaë¡œ ì´ˆê¸°í™”ë¨**
- í•™ìŠµ ì´ˆê¸°ì— **Stellaì™€ ì™„ì „ížˆ ë‹¤ë¥¸ í‘œí˜„**ì„ ë”°ë¼ê°€ë ¤ í•˜ë©´ â†’ **loss landscapeê°€ ë¶ˆì•ˆì •**
- Stellaë¥¼ teacherë¡œ ë‘ë©´ ì´ˆê¸° í‘œí˜„ê³¼ teacher í‘œí˜„ì´ **ìžì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°**ë˜ì–´ â†’ **ìˆ˜ë ´ ì†ë„ ë° ì•ˆì •ì„± ê°œì„ **

â†’ âš ï¸ í•™ìŠµ ì´ˆê¸°ì— â€œëª¨ë¸ ìžì‹ ì´ ì›ëž˜ ë‚´ë˜ ë²¡í„°â€ì™€ ì •ë ¬ë˜ë©´ **gradient ë°©í–¥ì´ ë„ˆë¬´ íŠ€ì§€ ì•ŠìŒ**

---

### 2ï¸âƒ£ í‘œí˜„ ë‹¤ì–‘ì„± í™•ë³´

- NV-EmbedëŠ” 7.8Bë¡œ ë” í¬ê³ , ë‹¤ì–‘í•œ ì •ë³´ë¥¼ ë‹´ê³  ìžˆìŒ
    
    â†’ ê·¸ëŸ¬ë‚˜ Jasperê°€ ê·¸ í‘œí˜„ë§Œ ë”°ë¼ê°€ë©´ **ëª¨ë¸ì´ ê³¼ì í•©ë˜ê±°ë‚˜ ë²¡í„° í’ˆì§ˆì´ ì™œê³¡**ë  ìˆ˜ ìžˆìŒ
    
- StellaëŠ” **ìžì—°ìŠ¤ëŸ½ê³  ê¹”ë”í•œ í‘œí˜„**ì„ ê°€ì§„ 1.5B ëª¨ë¸
    
    â†’ ì´ë¥¼ í•¨ê»˜ teacherë¡œ ì‚¬ìš©í•˜ë©´ JasperëŠ” **ë‘ í‘œí˜„ì˜ ì¤‘ê°„ ì§€ì **ì—ì„œ **ë” ì¼ë°˜í™”ëœ ìž„ë² ë”©**ì„ í•™ìŠµí•˜ê²Œ ë¨
    

---

### 3ï¸âƒ£ Teacher ê°„ ìƒë³´ì„± (complementarity)

- NV-Embed â†’ SOTA ëª¨ë¸ì´ì§€ë§Œ, í•™ìŠµì ìœ¼ë¡œ ë¶€ë‹´ì´ í¼
- Stella â†’ êµ¬ì¡°ì ìœ¼ë¡œ ìœ ì‚¬í•˜ê³ , í‘œí˜„ì´ Jasperì™€ í˜¸í™˜ë¨
- â†’ ì´ ë‘˜ì„ **concatí•˜ì—¬ teacher ë²¡í„°ë¡œ ì‚¬ìš©**í•˜ë©´:
    - NV-Embedì˜ ì •ë³´ëŸ‰
    - Stellaì˜ ì•ˆì •ì„±ê³¼ í‘œí˜„ë ¥
        
        ì„ **ëª¨ë‘ distill ê°€ëŠ¥**
        

---

## âœ… ê²°ë¡ : Stellaë¥¼ teacherë¡œ ì“°ëŠ” ê±´ "í•©ë¦¬ì ì´ê³  ì „ëžµì ì¸ ì„ íƒ"

| í•­ëª© | Stella teacherë¡œ ì“°ëŠ” íš¨ê³¼ |
| --- | --- |
| ì´ˆê¸° ì•ˆì •ì„± | init ëª¨ë¸ê³¼ì˜ í‘œí˜„ ì •ë ¬ë¡œ í•™ìŠµ ìˆ˜ë ´ ë¹¨ë¼ì§ |
| í‘œí˜„ ë‹¤ì–‘ì„± | NV-Embedì™€ ë‹¤ë¥¸ í‘œí˜„ì„ ì¶”ê°€í•˜ì—¬ ì¼ë°˜í™” |
| distill í’ˆì§ˆ | teacher í‘œí˜„ ë¶„í¬ë¥¼ softí•˜ê²Œ ë§Œë“¤ì–´ì¤Œ |
| í•™ìŠµ ë‚œì´ë„ ì¡°ì ˆ | ë„ˆë¬´ í° teacher í•˜ë‚˜ë§Œ ì«“ëŠ” risk ë¶„ì‚° |

ì¶”ê°€ì ìœ¼ë¡œ Jasper ë…¼ë¬¸ì—ì„œ **Stellaë¥¼ teacherë¡œ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ì´ìœ **ëŠ”,

LLMì—ì„œ DPO(Direct Preference Optimization)ê°€ KL-divergenceë¥¼ ì†ì‹¤ì— í¬í•¨ì‹œí‚¤ëŠ” ê²ƒê³¼ **ì •í™•ížˆ ìœ ì‚¬í•œ ëª©ì **ì„ ê°€ì§€ê³  ìžˆìŠµë‹ˆë‹¤.

---

## ðŸ” ìœ ì‚¬í•œ êµ¬ì¡°: DPOì˜ KL-divergence vs Jasperì˜ Stella teacher

| ê°œë… | DPO | Jasper |
| --- | --- | --- |
| ëª©ì  | ê¸°ì¡´ reference ëª¨ë¸ê³¼ **í° ì°¨ì´ë¥¼ ë°©ì§€** | init ëª¨ë¸(Stella)ê³¼ **ê¸‰ê²©í•œ í‘œí˜„ ë³€í™” ë°©ì§€** |
| ë°©ì‹ | KL-divergenceë¥¼ í†µí•´ Ï€ì™€ Ï€â‚€ ê°„ ê±°ë¦¬ ì œì•½ | Stella ë²¡í„°ë¥¼ teacherë¡œ ì‚¼ì•„ ì •ë ¬ loss ì ìš© |
| íš¨ê³¼ | í•™ìŠµ ì•ˆì •ì„± ìœ ì§€, catastrophic drift ë°©ì§€ | ëª¨ë¸ ì´ˆê¸° í‘œí˜„ ë³´ì¡´ + ì•ˆì •ì ì¸ í•™ìŠµ ë°©í–¥ì„± |

---

## ðŸ“Œ Jasperì—ì„œ Stella ì‚¬ìš©ë„ ê°™ì€ ë§¥ë½

- Stella = init ëª¨ë¸ì´ìž teacher â†’ **ì´ˆê¸° í‘œí˜„ ë¶„í¬ì˜ ì•”ë¬µì ì¸ ê¸°ì¤€ì **
- Jasperê°€ NV-Embedë§Œ ë”°ë¼ê°€ë©´ í‘œí˜„ì´ ì§€ë‚˜ì¹˜ê²Œ ë°”ë€ŒëŠ” ìœ„í—˜
- ë”°ë¼ì„œ Stellaë¥¼ í•¨ê»˜ teacherë¡œ ì‚¼ìœ¼ë©´:
    
    > "ì¶œë°œì (Stella)ì˜ ë¶„í¬ë¥¼ ì¼ì • ë¶€ë¶„ ìœ ì§€í•˜ë©° NV-Embedë¡œ ìˆ˜ë ´"
    > 
    > 
    > â†’ ê²°ê³¼ì ìœ¼ë¡œ DPOì˜ KL ì—­í• ê³¼ ë™ì¼í•œ **drift-regularization íš¨ê³¼**
    > 

---

## âœ… ê²°ë¡ 

> DPOì˜ KL-divergenceì™€ Jasperì˜ Stella-distillationì€ ë³¸ì§ˆì ìœ¼ë¡œ ê°™ì€ ì˜ë„:
> 
> 
> **"ê¸°ì¤€ ëª¨ë¸(reference)ì˜ í‘œí˜„ì„ ë³´ì¡´í•˜ë©´ì„œ, ë” ë‚˜ì€ ëª©í‘œ ëª¨ë¸ë¡œ ë¶€ë“œëŸ½ê²Œ ì´ë™"**
>
